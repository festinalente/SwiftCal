function SwiftCal(){var M,a,D,d,r,o=!1,O=[],U=[],F=[],R=[],s=1,G=!1,l=0;function c(e,t){!1===R.includes(t)&&(e.style.backgroundColor="#fc3",R.push(t),O[R.length-1]={day:t,humanDate:P(t)})}function u(e,t){t=R.indexOf(t);if(e.style.backgroundColor="#fff",R.splice(1,t),O.splice(1,t),e.children)for(i=e.children.length-1;0<=i;i--)e.children[i].remove()}function m(){for(var e=O[0].day,t=O[1].day,n=D.querySelector("[id='"+e+"']").dataset.dayindex,i=D.querySelector("[id='"+t+"']").dataset.dayindex,l=function(){return 0<n-i?[i,n]:[n,i]},e=parseInt(l()[0]),a=parseInt(l()[1]),d=e;d<=a;d++){var r=D.querySelector('[data-dayindex = "'+d+'"]');if(r.classList.contains("blocked")){D.querySelector("[id='"+t+"']").style.backgroundColor="white",R.splice(1,1),O.splice(1,1);break}r=r.id;c(D.querySelector("[id='"+r+"']"),r),d===a&&(R.push(R.splice(1,1)[0]),O.push(O.splice(1,1)[0]))}}function N(e,n){var t,l,a="";if(n.children)for(i=n.children.length-1;0<=i;i--)n.children[i].remove();e&&0<e.length&&(t=g(e),l=R.indexOf(n.id),O[l].times=JSON.parse(JSON.stringify(e)),t.forEach(function(e,t){a+=e+" ";e=document.createElement("p");e.classList.add("calendarTime"),e.style.marginBottom="0px",e.textContent=a,!1===n.classList.contains("filler")&&(n.style.backgroundColor="#fc3",a=(t%2==1&&(e.style.borderBottomStyle="solid"),n.appendChild(e),""))}))}function e(){return O.forEach(function(e,t){document.getElementById(e.day).style.backgroundColor="#fff",O.splice(1,t),R.splice(1,t)}),this}function h(e){for(var t=a.dataset.dayofweek,n=document.querySelectorAll("[data-dayofweek='"+t+"']"),i=0;i<n.length;i++){var l=document.getElementById(n[i].id);l!==a&&(u(l,n[i].id),C(n[i].id))}}function W(e){var t=e.target;if(s++,!(a=t).classList.contains("blocked")){D.querySelector(".makeTimeRuleGlobal")&&(D.querySelector(".makeTimeRuleGlobalClass").textContent=k("Set these times for all ","days"));var n=t.dataset.day,e=t.parentElement.parentElement.dataset.month,e=f(t.parentElement.parentElement.dataset.year,e,n);if(!0!==o)if(!0!==M){if(!1===R.includes(e)){n=r.querySelector(".makeTimeRuleGlobal");n&&!0===n.checked&&y(e,null),c(t,e),L(e,null),!0===G&&(d.style.height=D.clientHeight+"px",d.style.width=D.clientWidth+"px",d.style.display="inline",j(r,D))}else if(t.style.backgroundColor="white",R.splice(R.indexOf(e),1),O.splice(R.indexOf(e),1),!0===G)for(;t.children[0];)t.removeChild(t.children[0])}else{if(s%2==0){R.length=0,O.length=0;for(var i=document.getElementsByClassName("dayTime"),l=0;l<i.length;l++)i[l].classList.contains("blocked")||(i[l].style.backgroundColor="white");t.style.backgroundColor="#fc3",c(t,e)}s%2==1&&(c(t,e),m())}}}times={indexes:[],values:[]},time={};var J=function(e,t){return new Date(t,e,0).getDate()};function f(e,t,n){return e+"-"+t+"-"+n}function P(e){e=e.split("-");return e[0]+"-"+(parseInt(e[1])+1)+"-"+e[2]}function Y(e,t,n,i,l){var a=document.createElement("p");a.id=t,a.textContent=n,e.appendChild(a),a.title=i,a.classList.add("deleteButton"),a.addEventListener("click",function(e){l(e)})}function y(e){var e=document.getElementById(e).dataset.dayofweek,n=document.querySelectorAll("[data-dayofweek='"+e+"']");n.forEach(function(e,t){!1===e.classList.contains("filler")&&(c(document.getElementById(e.id),e.id),L(e.id),n.length)})}function H(e){D.querySelectorAll(".dayTime").forEach(function(e){"rgb(255, 204, 51)"===e.style.backgroundColor&&0===e.children.length&&e.click()}),times.values%2==1?swiftmoAlert&&swiftmoAlert.setContent("Warning, you're missing an end time for the last time gap you entered.").toggle():0===times.values.length?D.querySelector(".timeChooserModal").style.display="none":v(times.values[times.values.length-1])<v(times.values[times.values.length-2])?swiftmoAlert&&swiftmoAlert.setContent("Warning, you've entered an end time which is before the start time.").toggle():!1===t(times.values)?swiftmoAlert&&swiftmoAlert.setContent("Warning, that time overlaps with other times you've already selected.").toggle():D.querySelector(".timeChooserModal").style.display="none"}function v(e){e=e.split(":");return 60*parseInt(e[0])*60*1e3+60*parseInt(e[1])*1e3}function g(e){var d=[];return t(e);function r(e,t){return e-t}function t(e){for(var t=[],n=0;n<e.length;n++)if(t.push(v(e[n])),n===e.length-1)return i(e,t)}function i(e,t){for(var n=JSON.parse(JSON.stringify(t)),i=t.sort(r),l=0;l<n.length;l++){var a=i.indexOf(n[l]);if(d.splice(l,1,e[a]),l===t.length-1)return d}}}function t(e){var t=[];if(e.length%2==0)for(var n=0;n<e.length;n++)t.push(v(e[n]));for(var i=0;i<t.length;i++)if(2<=i&&i%2==0)for(var l=t[i],a=t[i+1],d=0;d<t.length;d++)if(d%2==0&&i!==d){var r=t[d],o=t[d+1];return!(l<o&&o<a)&&(!(r<l&&a<o)&&((l!==r||a!==o)&&!(r<a&&a<o)))}}function C(e){for(e=e?document.getElementById(e):document.getElementById(O[O.length-1].day),i=e.children.length;0<=i;i--)e.children[i]&&e.children[i].remove()}function n(){var e=D.querySelector(".timeChooser"),t=e.querySelector(".makeTimeRuleGlobal"),n=D.querySelectorAll(".timePickerContainer");2<=n.length?(e.removeChild(n[n.length-1]),times.indexes.length%2==0?(times.indexes.splice(times.indexes.length-2,2),times.values.splice(times.values.length-2,2)):(times.indexes.splice(times.indexes.length-1,1),times.values.splice(times.values.length-1,1)),N(times.values,a)):(e.querySelectorAll("select").forEach(function(e){e.selectedIndex=0}),times.indexes.length%2==0?(times.indexes.splice(times.indexes.length-2,2),times.values.splice(times.values.length-2,2)):(times.indexes.splice(times.indexes.length-1,1),times.values.splice(times.values.length-1,1)),t.checked=!1,N(times.values,a),0===D.querySelector(a.id).children.length&&a.click()),!0===t.checked?y(a.id,l):h(a.id)}function V(e){(d=document.createElement("div")).classList.add("timeChooserModal"),e.appendChild(d);e=document.createElement("div");e.classList.add("timeCont"),d.appendChild(e),d.addEventListener("click",function(e){!1===e.target.classList.contains("timeChooserModal")||H()}),(r=document.createElement("div")).classList.add("timeChooser"),e.appendChild(r);e=document.createElement("div");return e.classList.add("deleteDiv"),Y(e,"addTime","+","add a time",E),Y(e,"removeTime","-","remove last time",n),Y(e,"deleteButton","x","close",H),r.appendChild(e),this}function E(){var e,t;2*D.querySelectorAll(".timePickerContainer").length===times.values.length?((e=document.createElement("div")).classList.add("timePickerContainer"),r.appendChild(e),(t=document.createElement("div")).textContent="Add time:",t.classList.add("deleteDiv"),e.appendChild(t),x("Start",e,t=l),x("End",e,t),b(e),l++):swiftmoAlert?swiftmoAlert.setContent("Fill in the current time values before adding another.").toggle():alert("Fill in the current time values before adding another.")}function S(){var e=document.querySelectorAll(".timePickerContainer");e[e.length-1].scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}function k(e,t,n){return e+["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][n=n||parseInt(a.dataset.dayofweek)]+t}function b(e){var t,n=e,i=document.createElement("p"),e=k("Set these times for all ","days");0===l?(i.textContent=e,i.classList.add("timeSelectP","makeTimeRuleGlobalClass"),i.htmlFor="makeTimeRuleGlobal",n.appendChild(i),(t=document.createElement("input")).setAttribute("type","checkbox"),t.name="makeTimeRuleGlobal",t.classList.add("makeTimeRuleGlobal"),n.appendChild(t),t.addEventListener("click",function(e){!1===t.checked?h(a.id):y(a.id,l)})):i.textContent=k("Set these times for all ","days"),S()}function x(e,t,n){var i=document.createElement("div");i.classList.add("timeContainer");var l=document.createElement("p");l.classList.add("timeSelectP"),l.textContent=e+":",i.appendChild(l);l=document.createElement("div");l.id=e+"-"+n,n&&l.classList.add(n),l.classList.add("hour","times",e),i.appendChild(l),w("hh",24,l.id,l,e,n),w("mm",59,l.id,l,e,n),t.appendChild(i)}function w(t,e,n,i,l,a){time[t]="00";var d=document.createElement("select");d.classList.add(t,n+"-"+t,"timeSelect");var r=0,n=document.createElement("option");for(n.textContent=t,n.value="00",d.appendChild(n);r<=e;){var o=document.createElement("option"),s=r.toString();1===s.length&&(s="0"+r),o.value=s,o.textContent=s,d.appendChild(o),r++}d.addEventListener("click",function(){var e;time[t]=d.value,"hh"===t&&(time.mm="00",d.nextSibling.selectedIndex="1"),times.indexes.includes(l+"-"+a)?(e=times.indexes.indexOf(l+"-"+a),times.values[e]=time.hh+":"+time.mm):(times.indexes.push(l+"-"+a),times.values.push(time.hh+":"+time.mm)),L(null)}),i.appendChild(d)}function j(e,t){var n=t.getBoundingClientRect(),i=n.x,t=n.y,n=i+(n.width-e.getBoundingClientRect().width)/2;e.style.top=t+10+"px",e.style.left=n+"px"}function L(e){null===e&&(!0===D.querySelector(".makeTimeRuleGlobal").checked?y(a.id):N(times.values,a)),e&&N(times.values,D.querySelector("[id='"+e+"']"))}function q(e){let t=new Uint32Array(e);window.crypto.getRandomValues(t);let n="";for(let e=0;e<t.length;e++)if(n+=t[e],e===t.length-1)return n}function z(){let e=q(10);if(!document.querySelector("calendar"+e))return e;e()}Date.prototype.addMonths=function(e){var t=new Date(this),n=Math.floor(e/12),e=e-12*n;return n&&t.setFullYear(t.getFullYear()+n),e&&t.setMonth(t.getMonth()+e),t},this.collectEndUserSelection=function(){return U},this.setSaveAction=function(e){return this},this.datesSelected=function(){return O},this.showTimes=function(){return times},this.datesSelectedTracker=function(){return R},this.clearSelection=function(){return e},this.disable=function(){o=!0},this.range=function(e){return M=e,this},this.calendar=function(e,t,n,i,a,l,d){function r(i){i.addEventListener("click",function(){var e,t,n;F.includes(i.id)?(i.style.borderStyle="none",U.splice(F.indexOf(i.id),1),F.splice(F.indexOf(i.id),1)):(i.style.borderStyle="solid",i.style.borderColor="blue",n=i.children[0].textContent.split(" "),e=1,t=parseInt(n[1])-parseInt(n[0]),n=document.getElementById(i.id).firstChild.nextSibling.textContent,U.push({day:i.id,duration:e,timeGap:n,humanDate:P(i.id)}),F.push(i.id),!0===a&&!0===l&&(s(i.id,e,t),j("durationChooser",D),document.addEventListener("click",function(e){var t=document.getElementById("durationInput"+calendarUniqueId).contains(e.target);t&&c(),t||e.target!==document.getElementById("durationChooserModal"+calendarUniqueId)||(document.getElementById("durationChooserModal"+calendarUniqueId).style.display="none",c())})))})}function o(){var e=document.createElement("div");e.classList.add("timeChooserModal"),e.id="durationChooserModal";var t=document.createElement("div");t.classList.add("timeChooser"),t.id="durationChooser",e.appendChild(t),D.appendChild(e);var n=document.createElement("div");n.textContent="Duration:",n.classList.add("deleteDiv"),t.appendChild(n),Y(n,"deleteButton","x","close",H);e=document.createElement("div");e.classList.add("timeContainer");n=document.createElement("label");n.setAttribute("id","calendarLabel"),n.setAttribute("for","hourSelect"),n.textContent="hours:",e.appendChild(n);n=document.createElement("input");n.setAttribute("type","number"),n.id="durationInput",n.classList.add("hour"),e.appendChild(n),t.appendChild(e)}function s(e,t,n){document.getElementById("durationInput"+calendarUniqueId).setAttribute("min",t),document.getElementById("durationInput"+calendarUniqueId).setAttribute("max",n),document.getElementById("durationInput"+calendarUniqueId).value="1",document.getElementById("durationChooserModal"+calendarUniqueId).style.height=D.clientHeight+"px",document.getElementById("durationChooserModal"+calendarUniqueId).style.width=D.clientWidth+"px",document.getElementById("durationChooserModal"+calendarUniqueId).style.display="inline"}function c(){var e=document.getElementById("durationInput"+calendarUniqueId).value;U[U.length-1].duration=e}function u(e,t){if(t){O=t;for(var n=0;n<=t.length-1;n++){var i,l="[id='"+t[n].day+"']";null!==e.querySelector(l)&&(R.push(t[n].day),e.querySelector(l).style.backgroundColor="#fc3",e.querySelector(l).classList.add("available"),!0===a&&(r(e.querySelector(l)),o()),!0===G&&N(t[n].times,e.querySelector(l)),!0===M&&null!==e.querySelector(l)&&!1===e.querySelector(l).classList.contains("filler")&&(e.querySelector(l).style.backgroundColor="#333",e.querySelector(l).classList.add("blocked"),e.querySelector(l).title="No availability on this day",(i=document.createElement("p")).classList.add("calendarTime"),i.textContent="Sold out",e.querySelector(l).appendChild(i)))}}}if(calendarUniqueId=z(),(D=document.createElement("div")).classList.add("calendar"),("string"==typeof e?document.querySelector(e):e).appendChild(D),D.id="calendar"+calendarUniqueId,!0===i&&(G=!0,V(D)),void 0===n&&(n=4),!0===d){var m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=document.createElement("div");h.classList.add("dayblockrow");i=document.createElement("h4");if(i.textContent="Select days of week to block:",h.appendChild(i),m.forEach(function(e,t){var n=document.createElement("input");n.setAttribute("type","checkbox"),n.classList.add("block"),n.name=e,n.dataset.block=m.indexOf(e),h.appendChild(n);n=document.createElement("label");n.for=e,n.textContent=e,h.appendChild(n)}),D.appendChild(h),d)for(var f=document.getElementsByClassName("block"),y=0;y<f.length;y++)f[y].addEventListener("click",function(e){var t=document.querySelectorAll("[data-dayofweek='"+e.target.dataset.block+"']");if(e.target.checked)for(y=0;y<t.length;y++)t[y].classList.add("widthShape","filler");else for(y=0;y<t.length;y++)t[y].classList.remove("filler")})}for(var v=[],d=new Date,g=d.getMonth(),C=(d.getFullYear(),["January","February","March","April","May","June","July","August","September","October","November","December"]),E=0,y=0;y<n;y++){v.push(document.createElement("div")),D.appendChild(v[y]),v[y].style.width="15em",v[y].style.backgroundColor="#f15925",v[y].classList.add("month");var S=document.createElement("div");S.textContent=C[(g+y)%12],S.classList.add("monthName"),v[y].appendChild(S);var S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=document.createElement("div");k.classList.add("weekrow"),v[y].appendChild(k),S.forEach(function(e){var t=document.createElement("div");k.appendChild(t),t.textContent=e,t.classList.add("dayName","widthShapeDays")});var b=[],x=document.createElement("div");v[y].appendChild(x),x.classList.add("weekrow");var w=(new Date).addMonths(y).getFullYear(),L=(g+y)%12,q=new Date(w,L).getDay(),I=(new Date).getDate(),A=J((g+y+1)%12,(new Date).addMonths(y).getFullYear());v[y].dataset.year=w,v[y].dataset.month=L,v[y].id=L+"-"+w;var B=1,T=0;for(p=0;p<=41;p++)p<q&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white",T++),0===y&&p>=q&&p<I+q-1&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white"),p>=q&&p<A+q&&(b.push(document.createElement("div")),b[p].textContent=B,b[p].dataset.day=B,b[p].dataset.dayofweek=T,b[p].dataset.dayindex=E,x.appendChild(b[p]),b[p].classList.add("widthShape","dayTime"),b[p].id=w+"-"+L+"-"+B,b[p].addEventListener("click",W,!1),B++,T++,E++),p>=A+q&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white"),(p+1)%7==0&&(x=document.createElement("div"),v[y].appendChild(x),x.classList.add("weekrow"),T=0);y===n-1&&u(D,t)}return this}}function SwiftCal(){var M,d,D,O,U,r=!1,F=[],R=[],G=[],N=[],o=1,W=!1,l=0;function s(e,t){!1===N.includes(t)&&(e.style.backgroundColor="#fc3",N.push(t),F[N.length-1]={day:t,humanDate:Y(t)})}function J(e,n){var t,l,d,a="";if(n.children)for(i=n.children.length-1;0<=i;i--)n.children[i].remove();function r(e,t){return e-t}e&&0<e.length&&(d=[],t=function(e){for(var t=[],n=0;n<e.length;n++)if(t.push(u(e[n])),n===e.length-1)return function(e,t){for(var n=JSON.parse(JSON.stringify(t)),i=t.sort(r),l=0;l<n.length;l++){var a=i.indexOf(n[l]);if(d.splice(l,1,e[a]),l===t.length-1)return d}}(e,t)}(e),l=N.indexOf(n.id),F[l].times=JSON.parse(JSON.stringify(e)),t.forEach(function(e,t){a+=e+" ";e=document.createElement("p");e.classList.add("calendarTime"),e.style.marginBottom="0px",e.textContent=a,!1===n.classList.contains("filler")&&(n.style.backgroundColor="#fc3",a=(t%2==1&&(e.style.borderBottomStyle="solid"),n.appendChild(e),""))}))}function e(){return F.forEach(function(e,t){document.getElementById(e.day).style.backgroundColor="#fff",F.splice(1,t),N.splice(1,t)}),this}function a(){for(var e=d.dataset.dayofweek,t=document.querySelectorAll("[data-dayofweek='"+e+"']"),n=0;n<t.length;n++){var l=document.getElementById(t[n].id);l!==d&&(function(e,t){if(t=N.indexOf(t),e.style.backgroundColor="#fff",N.splice(1,t),F.splice(1,t),e.children)for(i=e.children.length-1;0<=i;i--)e.children[i].remove()}(l,t[n].id),function(e){e=e?document.getElementById(e):document.getElementById(F[F.length-1].day);for(i=e.children.length;0<=i;i--)e.children[i]&&e.children[i].remove()}(t[n].id))}}function P(e){var t=e.target;if(o++,!(d=t).classList.contains("blocked")){D.querySelector(".makeTimeRuleGlobal")&&(D.querySelector(".makeTimeRuleGlobalClass").textContent=h("Set these times for all ","days"));var n=t.dataset.day,i=t.parentElement.parentElement.dataset.month,e=t.parentElement.parentElement.dataset.year,i=e+"-"+i+"-"+n;if(!0!==r)if(!0!==M){if(!1===N.includes(i)){n=U.querySelector(".makeTimeRuleGlobal");n&&!0===n.checked&&c(i),s(t,i),v(i),!0===W&&(O.style.height=D.clientHeight+"px",O.style.width=D.clientWidth+"px",O.style.display="inline",K(U,D))}else if(t.style.backgroundColor="white",N.splice(N.indexOf(i),1),F.splice(N.indexOf(i),1),!0===W)for(;t.children[0];)t.removeChild(t.children[0])}else{if(o%2==0){N.length=0,F.length=0;for(var l=document.getElementsByClassName("dayTime"),a=0;a<l.length;a++)l[a].classList.contains("blocked")||(l[a].style.backgroundColor="white");t.style.backgroundColor="#fc3",s(t,i)}o%2==1&&(s(t,i),function(){function e(){return 0<i-l?[l,i]:[i,l]}for(var t=F[0].day,n=F[1].day,i=D.querySelector("[id='"+t+"']").dataset.dayindex,l=D.querySelector("[id='"+n+"']").dataset.dayindex,t=parseInt(e()[0]),a=parseInt(e()[1]),d=t;d<=a;d++){var r=D.querySelector('[data-dayindex = "'+d+'"]');if(r.classList.contains("blocked")){D.querySelector("[id='"+n+"']").style.backgroundColor="white",N.splice(1,1),F.splice(1,1);break}r=r.id;s(D.querySelector("[id='"+r+"']"),r),d===a&&(N.push(N.splice(1,1)[0]),F.push(F.splice(1,1)[0]))}}())}}}times={indexes:[],values:[]},time={};function Y(e){e=e.split("-");return e[0]+"-"+(parseInt(e[1])+1)+"-"+e[2]}function H(e,t,n,i,l){var a=document.createElement("p");a.id=t,a.textContent=n,e.appendChild(a),a.title=i,a.classList.add("deleteButton"),a.addEventListener("click",function(e){l(e)})}function c(e){var e=document.getElementById(e).dataset.dayofweek,n=document.querySelectorAll("[data-dayofweek='"+e+"']");n.forEach(function(e,t){!1===e.classList.contains("filler")&&(s(document.getElementById(e.id),e.id),v(e.id),n.length)})}function V(e){document.querySelector("#shopTimeTable").querySelectorAll(".dayTime").forEach(function(e){"rgb(255, 204, 51)"===e.style.backgroundColor&&0===e.children.length&&e.click()}),times.values%2==1?swiftmoAlert&&swiftmoAlert.setContent("Warning, you're missing an end time for the last time gap you entered.").toggle():0===times.values.length?D.querySelector(".timeChooserModal").style.display="none":u(times.values[times.values.length-1])<u(times.values[times.values.length-2])?swiftmoAlert&&swiftmoAlert.setContent("Warning, you've entered an end time which is before the start time.").toggle():!1===function(e){var t=[];if(e.length%2==0)for(var n=0;n<e.length;n++)t.push(u(e[n]));for(var i=0;i<t.length;i++)if(2<=i&&i%2==0)for(var l=t[i],a=t[i+1],d=0;d<t.length;d++)if(d%2==0&&i!==d){var r=t[d],o=t[d+1];return!(l<o&&o<a)&&(!(r<l&&a<o)&&((l!==r||a!==o)&&!(r<a&&a<o)))}}(times.values)?swiftmoAlert&&swiftmoAlert.setContent("Warning, that time overlaps with other times you've already selected.").toggle():D.querySelector(".timeChooserModal").style.display="none"}function u(e){e=e.split(":");return 60*parseInt(e[0])*60*1e3+60*parseInt(e[1])*1e3}function j(){var e=D.querySelector(".timeChooser"),t=e.querySelector(".makeTimeRuleGlobal"),n=D.querySelectorAll(".timePickerContainer");2<=n.length?(e.removeChild(n[n.length-1]),times.indexes.length%2==0?(times.indexes.splice(times.indexes.length-2,2),times.values.splice(times.values.length-2,2)):(times.indexes.splice(times.indexes.length-1,1),times.values.splice(times.values.length-1,1)),J(times.values,d)):(e.querySelectorAll("select").forEach(function(e){e.selectedIndex=0}),times.indexes.length%2==0?(times.indexes.splice(times.indexes.length-2,2),times.values.splice(times.values.length-2,2)):(times.indexes.splice(times.indexes.length-1,1),times.values.splice(times.values.length-1,1)),t.checked=!1,J(times.values,d),0===D.querySelector(d.id).children.length&&d.click()),(!0===t.checked?c:a)(d.id)}function z(){var e,t,n,i;2*D.querySelectorAll(".timePickerContainer").length===times.values.length?((i=document.createElement("div")).classList.add("timePickerContainer"),U.appendChild(i),(e=document.createElement("div")).textContent="Add time:",e.classList.add("deleteDiv"),i.appendChild(e),f("Start",i,n=l),f("End",i,n),n=e=i,i=document.createElement("p"),e=h("Set these times for all ","days"),0===l?(i.textContent=e,i.classList.add("timeSelectP","makeTimeRuleGlobalClass"),i.htmlFor="makeTimeRuleGlobal",n.appendChild(i),(t=document.createElement("input")).setAttribute("type","checkbox"),t.name="makeTimeRuleGlobal",t.classList.add("makeTimeRuleGlobal"),n.appendChild(t),t.addEventListener("click",function(e){(!1===t.checked?a:c)(d.id)})):i.textContent=h("Set these times for all ","days"),m(),l++):swiftmoAlert?swiftmoAlert.setContent("Fill in the current time values before adding another.").toggle():alert("Fill in the current time values before adding another.")}function m(){var e=document.querySelectorAll(".timePickerContainer");e[e.length-1].scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}function h(e,t,n){return e+["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][n=n||parseInt(d.dataset.dayofweek)]+t}function f(e,t,n){var i=document.createElement("div");i.classList.add("timeContainer");var l=document.createElement("p");l.classList.add("timeSelectP"),l.textContent=e+":",i.appendChild(l);l=document.createElement("div");l.id=e+"-"+n,n&&l.classList.add(n),l.classList.add("hour","times",e),i.appendChild(l),y("hh",24,l.id,l,e,n),y("mm",59,l.id,l,e,n),t.appendChild(i)}function y(t,e,n,i,l,a){time[t]="00";var d=document.createElement("select");d.classList.add(t,n+"-"+t,"timeSelect");var r=0,n=document.createElement("option");for(n.textContent=t,n.value="00",d.appendChild(n);r<=e;){var o=document.createElement("option"),s=r.toString();1===s.length&&(s="0"+r),o.value=s,o.textContent=s,d.appendChild(o),r++}d.addEventListener("click",function(){var e;time[t]=d.value,"hh"===t&&(time.mm="00",d.nextSibling.selectedIndex="1"),times.indexes.includes(l+"-"+a)?(e=times.indexes.indexOf(l+"-"+a),times.values[e]=time.hh+":"+time.mm):(times.indexes.push(l+"-"+a),times.values.push(time.hh+":"+time.mm)),v(null)}),i.appendChild(d)}function K(e,t){var n=t.getBoundingClientRect(),i=n.x,t=n.y,n=i+(n.width-e.getBoundingClientRect().width)/2;e.style.top=t+10+"px",e.style.left=n+"px"}function v(e){null===e&&(!0===D.querySelector(".makeTimeRuleGlobal").checked?c(d.id):J(times.values,d)),e&&J(times.values,D.querySelector("[id='"+e+"']"))}function Q(){let e=function(e){var t=new Uint32Array(e);window.crypto.getRandomValues(t);let n="";for(let e=0;e<t.length;e++)if(n+=t[e],e===t.length-1)return n}(10);if(!document.querySelector("calendar"+e))return e;e()}Date.prototype.addMonths=function(e){var t=new Date(this),n=Math.floor(e/12),e=e-12*n;return n&&t.setFullYear(t.getFullYear()+n),e&&t.setMonth(t.getMonth()+e),t},this.collectEndUserSelection=function(){return R},this.setSaveAction=function(e){return this},this.datesSelected=function(){return F},this.showTimes=function(){return times},this.datesSelectedTracker=function(){return N},this.clearSelection=function(){return e},this.disable=function(){r=!0},this.range=function(e){return M=e,this},this.calendar=function(e,t,n,i,a,l,d){function r(n){n.addEventListener("click",function(){var e,t;G.includes(n.id)?(n.style.borderStyle="none",R.splice(G.indexOf(n.id),1),G.splice(G.indexOf(n.id),1)):(n.style.borderStyle="solid",n.style.borderColor="blue",e=n.children[0].textContent.split(" "),t=parseInt(e[1])-parseInt(e[0]),e=document.getElementById(n.id).firstChild.nextSibling.textContent,R.push({day:n.id,duration:1,timeGap:e,humanDate:Y(n.id)}),G.push(n.id),!0===a&&!0===l&&(n.id,e=1,t=t,document.getElementById("durationInput"+calendarUniqueId).setAttribute("min",e),document.getElementById("durationInput"+calendarUniqueId).setAttribute("max",t),document.getElementById("durationInput"+calendarUniqueId).value="1",document.getElementById("durationChooserModal"+calendarUniqueId).style.height=D.clientHeight+"px",document.getElementById("durationChooserModal"+calendarUniqueId).style.width=D.clientWidth+"px",document.getElementById("durationChooserModal"+calendarUniqueId).style.display="inline",K("durationChooser",D),document.addEventListener("click",function(e){var t=document.getElementById("durationInput"+calendarUniqueId).contains(e.target);t&&o(),t||e.target!==document.getElementById("durationChooserModal"+calendarUniqueId)||(document.getElementById("durationChooserModal"+calendarUniqueId).style.display="none",o())})))})}function o(){var e=document.getElementById("durationInput"+calendarUniqueId).value;R[R.length-1].duration=e}function s(e,t){if(t){F=t;for(var n=0;n<=t.length-1;n++){var i,l="[id='"+t[n].day+"']";null!==e.querySelector(l)&&(N.push(t[n].day),e.querySelector(l).style.backgroundColor="#fc3",e.querySelector(l).classList.add("available"),!0===a&&(r(e.querySelector(l)),function(){var e=document.createElement("div");e.classList.add("timeChooserModal"),e.id="durationChooserModal";var t=document.createElement("div");t.classList.add("timeChooser"),t.id="durationChooser",e.appendChild(t),D.appendChild(e);var n=document.createElement("div");n.textContent="Duration:",n.classList.add("deleteDiv"),t.appendChild(n),H(n,"deleteButton","x","close",V),(e=document.createElement("div")).classList.add("timeContainer"),(n=document.createElement("label")).setAttribute("id","calendarLabel"),n.setAttribute("for","hourSelect"),n.textContent="hours:",e.appendChild(n),(n=document.createElement("input")).setAttribute("type","number"),n.id="durationInput",n.classList.add("hour"),e.appendChild(n),t.appendChild(e)}()),!0===W&&J(t[n].times,e.querySelector(l)),!0===M&&null!==e.querySelector(l)&&!1===e.querySelector(l).classList.contains("filler")&&(e.querySelector(l).style.backgroundColor="#333",e.querySelector(l).classList.add("blocked"),e.querySelector(l).title="No availability on this day",(i=document.createElement("p")).classList.add("calendarTime"),i.textContent="Sold out",e.querySelector(l).appendChild(i)))}}}if(calendarUniqueId=Q(),(D=document.createElement("div")).classList.add("calendar"),("string"==typeof e?document.querySelector(e):e).appendChild(D),D.id="calendar"+calendarUniqueId,!0===i&&(W=!0,m=D,(O=document.createElement("div")).classList.add("timeChooserModal"),m.appendChild(O),(m=document.createElement("div")).classList.add("timeCont"),O.appendChild(m),O.addEventListener("click",function(e){!1===e.target.classList.contains("timeChooserModal")||V()}),(U=document.createElement("div")).classList.add("timeChooser"),m.appendChild(U),(m=document.createElement("div")).classList.add("deleteDiv"),H(m,"addTime","+","add a time",z),H(m,"removeTime","-","remove last time",j),H(m,"deleteButton","x","close",V),U.appendChild(m)),void 0===n&&(n=4),!0===d){var c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=document.createElement("div");u.classList.add("dayblockrow");var m=document.createElement("h4");if(m.textContent="Select days of week to block:",u.appendChild(m),c.forEach(function(e,t){var n=document.createElement("input");n.setAttribute("type","checkbox"),n.classList.add("block"),n.name=e,n.dataset.block=c.indexOf(e),u.appendChild(n);n=document.createElement("label");n.for=e,n.textContent=e,u.appendChild(n)}),D.appendChild(u),d)for(var h=document.getElementsByClassName("block"),f=0;f<h.length;f++)h[f].addEventListener("click",function(e){var t=document.querySelectorAll("[data-dayofweek='"+e.target.dataset.block+"']");if(e.target.checked)for(f=0;f<t.length;f++)t[f].classList.add("widthShape","filler");else for(f=0;f<t.length;f++)t[f].classList.remove("filler")})}for(var y,v=[],d=new Date,g=d.getMonth(),C=(d.getFullYear(),["January","February","March","April","May","June","July","August","September","October","November","December"]),E=0,f=0;f<n;f++){v.push(document.createElement("div")),D.appendChild(v[f]),v[f].style.width="15em",v[f].style.backgroundColor="#f15925",v[f].classList.add("month");var S=document.createElement("div");S.textContent=C[(g+f)%12],S.classList.add("monthName"),v[f].appendChild(S);var k=document.createElement("div");k.classList.add("weekrow"),v[f].appendChild(k),["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(function(e){var t=document.createElement("div");k.appendChild(t),t.textContent=e,t.classList.add("dayName","widthShapeDays")});var b=[],x=document.createElement("div");v[f].appendChild(x),x.classList.add("weekrow");var w=(new Date).addMonths(f).getFullYear(),L=(g+f)%12,q=new Date(w,L).getDay(),I=(new Date).getDate(),A=(y=(g+f+1)%12,S=(new Date).addMonths(f).getFullYear(),new Date(S,y,0).getDate());v[f].dataset.year=w,v[f].dataset.month=L,v[f].id=L+"-"+w;var B=1,T=0;for(p=0;p<=41;p++)p<q&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white",T++),0===f&&p>=q&&p<I+q-1&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white"),p>=q&&p<A+q&&(b.push(document.createElement("div")),b[p].textContent=B,b[p].dataset.day=B,b[p].dataset.dayofweek=T,b[p].dataset.dayindex=E,x.appendChild(b[p]),b[p].classList.add("widthShape","dayTime"),b[p].id=w+"-"+L+"-"+B,b[p].addEventListener("click",P,!1),B++,T++,E++),p>=A+q&&(b.push(document.createElement("div")),b[p].classList.add("widthShape","filler"),x.appendChild(b[p]),b[p].style.backgroundColor="white"),(p+1)%7==0&&(x=document.createElement("div"),v[f].appendChild(x),x.classList.add("weekrow"),T=0);f===n-1&&s(D,t)}return this}}
